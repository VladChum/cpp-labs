#include <vcl.h>
#pragma hdrstop
#include "Unit1.h"
#include "Steck.h"
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
Stack Stek;

//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm1::ButtonToSolveClick(TObject *Sender)
{
  Stek.Stack_init();
  AnsiString ed_txt = EditForEx->Text;
  Stek.s = ed_txt.c_str();
  Stek.check();
  if(Stek.err_code==all_true)
  {
	  Stek.bspaces();
	  Stek.s = Stek.sv;
	  Stek.postfix();
	  EditTranslated->Text=Stek.s;
  }
  Stek.s = ed_txt.c_str();
  //EditAnswer->Text=Stek.s;
  if(Stek.err_code==all_true)
  {
	  Stek.bspaces();
	  Stek.s = Stek.sv;
	  Stek.postfix();
   //	  EditAnswer->Text=Stek.s;
	  EditTranslated->Text=Stek.s;
	  float result=Stek.calc(StrToFloat(EditA->Text), StrToFloat(EditB->Text), StrToFloat(EditC->Text), StrToFloat(EditD->Text), StrToFloat(EditE->Text));
	  //float result=Stek.calc(EditA->Text.ToDouble(), EditB->Text.ToDouble(), EditC->Text.ToDouble(), EditD->Text.ToDouble(), EditE->Text.ToDouble());
	  EditAnswer->Text=FloatToStr(result);
  }
  else
  Stek.out_err_code();
}
//---------------------------------------------------------------------------

void Stack::out_err_code()
{
   switch(err_code)
   {
		case all_true: {ShowMessage("Ввод корректен."); break;}
		case bad_operands: {ShowMessage("В выражении есть неверные операнды!"); break;}
		case few_brackets: {ShowMessage("В выражении не хватает скобки!"); break;}
		case much_brackets: {ShowMessage("В выражении лишние скобки!"); break;}
		case few_operands: {ShowMessage("В выражении недостаточно операндов!"); break;}
		case few_operators: {ShowMessage("В выражении недостаточно знаков операций!"); break;}
   };
}
//---------------------------------------------------------------------------
void __fastcall TForm1::FormCreate(TObject *Sender)
{
   EditForEx->Text="";
   EditAnswer->Text="";
   EditTranslated->Text="";
}
//---------------------------------------------------------------------------

void __fastcall TForm1::ButtonExitClick(TObject *Sender)
{
  Close();
}
//---------------------------------------------------------------------------
void __fastcall TForm1::ButtonClearClick(TObject *Sender)
{
   EditForEx->Text="";
   EditAnswer->Text="";
   EditTranslated->Text="";
}
//---------------------------------------------------------------------------




